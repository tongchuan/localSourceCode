<?php

	class approvalController extends baseController{
		
		public function __construct(){
			parent::__construct();
		}
		public function index(){

				$this->load->model('posts');

				$vars['title'] = 'Dynamic title';
				$vars['posts'] = $this->posts->getEntries();
				$this->load->view('index',$vars);	
		}

		public function menu(){
			$data = '{"total":2,"rows":[{"level":1,"menuitemcode":"E1100201","menuitemname":"借款单据","tradetype":"263X-Cxx-13","submenu":[{"level":2,"menuitemcode":"E110020118","menuitemname":"借款单","tradetype":"263X-Cxx-1"},{"level":2,"menuitemcode":"E110020111","menuitemname":"通用借款单","tradetype":"263X-Cxx-2"}]},{"level":1,"menuitemcode":"E1100201","menuitemname":"收款合同","tradetype":"FCT1","submenu":[{"level":2,"menuitemcode":"E110020118","menuitemname":"收款合同FCT1-01","tradetype":"FCT1-01"},{"level":2,"menuitemcode":"E110020111","menuitemname":"收款合同FCT1-02","tradetype":"FCT1-02"}]}],"success":true}';
			if($_GET['callback']){
				$callback = $_GET['callback'];
				echo $callback.'('.$data.')';
			}else{
				echo $data;
			}
			
			exit();
		}

		public function countbill(){
			/*
	获取单据类型

EALINKID:"oneWeek" 时间 oneWeek周  oneMonth 月 "twoMonth"二月 "threeMonth"三月 "none"不限
isHasComplete:"false"
isHasCompletePortlet:"true"
isOtherQuery:false
likeQueryValue:"" 查询单据这里不用考虑
size:30 显示多少条
			*/
			// exit();
			$data =  '{"countData":[{"name":"通用借款单","num":1,"tradetype":"263X-Cxx-TYJKD"},{"name":"收款单","num":1,"tradetype":"D2"},{"name":"应付单","num":1,"tradetype":"D1"},{"name":"付款单","num":1,"tradetype":"D3"},{"name":"还款单","num":1,"tradetype":"2647"},{"name":"差旅费借款单","num":19,"tradetype":"2631"},{"name":"应收单","num":1,"tradetype":"D0"}],"success":true,"total":25}';
			if($_GET['callback']){
				$callback = $_GET['callback'];
				echo $callback.'('.$data.')';
			}else{
				echo $data;
			}
			exit();
		}

		public function query(){

			/*
	EALINKID:"oneWeek" 时间 oneWeek周  oneMonth 月 "twoMonth"二月 "threeMonth"三月 "none"不限
billStateQuery:"" 审批状态 默认为空，未提交-1 审批中2
expBillQueryType:"" 单据类型 根据回去单据类型中的
index:"0"  第几页 从零开始 
isHasComplete:"false"  是否完成
isHasCompletePortlet:"false"
likeQueryValue:""  查询单据 如"264X201609180037"
size:20  一页显示多少条
			*/
			$data = '{"rows":[{"approver":"1001A5100000000000JW","approverName":"T2","approvestatus":"1","billdate":"2016-09-14","billid":"0001A51000000001497P","billmaker":"1001A5100000000000JH","billno":"263X2016091400000064","billtype":"2631","creator":"1001A5100000000000JK","defitem1":"保存","defitem10":"1002Z0100000000001K1","defitem11":"费用管理","defitem17":"yer","defitem2":"审批通过","deptid":"1001A5100000000000G3","dirty":"false","djdl":"jk","djzt":"1","dr":"0","pKFieldName":"pk_yerbill","payflag":"1","payflagname":"未支付","pk_group":"0001A510000000000D5V","pk_org":"0001A510000000002U0V","pk_yerbill":"0001A51000000001497P","primaryKey":"0001A51000000001497P","shrq":"2016-09-14","status":"0","tableName":"yer_yerexpbill","total":"33.00","tradeTypeName":"差旅费借款单","tradetype":"2631"},{"approver":"1001A5100000000000JW","approverName":"T2","approvestatus":"1","billdate":"2016-09-14","billid":"0001A51000000001496D","billmaker":"1001A5100000000000JH","billno":"263X2016091400000063","billtype":"2631","creator":"1001A5100000000000JK","defitem1":"保存","defitem10":"1002Z0100000000001K1","defitem11":"费用管理","defitem17":"yer","defitem2":"审批通过","deptid":"1001A5100000000000G3","dirty":"false","djdl":"jk","djzt":"1","dr":"0","pKFieldName":"pk_yerbill","payflag":"1","payflagname":"未支付","pk_group":"0001A510000000000D5V","pk_org":"0001A510000000002U0V","pk_yerbill":"0001A51000000001496D","primaryKey":"0001A51000000001496D","shrq":"2016-09-14","status":"0","tableName":"yer_yerexpbill","total":"33.00","tradeTypeName":"差旅费借款单","tradetype":"2631"},{"approver":"1001A5100000000000JW","approverName":"T2","approvestatus":"1","billdate":"2016-09-14","billid":"0001A5100000000149E5","billmaker":"1001A5100000000000JH","billno":"263X2016091400000071","billtype":"2631","creator":"1001A5100000000000JK","defitem1":"保存","defitem10":"1002Z0100000000001K1","defitem11":"费用管理","defitem17":"yer","defitem2":"审批通过","deptid":"1001A5100000000000G3","dirty":"false","djdl":"jk","djzt":"1","dr":"0","pKFieldName":"pk_yerbill","payflag":"1","payflagname":"未支付","pk_group":"0001A510000000000D5V","pk_org":"0001A510000000002U0V","pk_yerbill":"0001A5100000000149E5","primaryKey":"0001A5100000000149E5","shrq":"2016-09-14","status":"0","tableName":"yer_yerexpbill","total":"9.31","tradeTypeName":"差旅费借款单","tradetype":"2631"},{"approver":"1001A5100000000000JW","approverName":"T2","approvestatus":"1","billdate":"2016-09-14","billid":"0001A5100000000149DB","billmaker":"1001A5100000000000JH","billno":"263X2016091400000070","billtype":"2631","creator":"1001A5100000000000JK","defitem1":"保存","defitem10":"1002Z0100000000001K1","defitem11":"费用管理","defitem17":"yer","defitem2":"审批通过","deptid":"1001A5100000000000G3","dirty":"false","djdl":"jk","djzt":"1","dr":"0","pKFieldName":"pk_yerbill","payflag":"1","payflagname":"未支付","pk_group":"0001A510000000000D5V","pk_org":"0001A510000000002U0V","pk_yerbill":"0001A5100000000149DB","primaryKey":"0001A5100000000149DB","shrq":"2016-09-14","status":"0","tableName":"yer_yerexpbill","total":"9.31","tradeTypeName":"差旅费借款单","tradetype":"2631"},{"approver":"1001A5100000000000JW","approverName":"T2","approvestatus":"1","billdate":"2016-09-14","billid":"0001A5100000000149GH","billmaker":"1001A5100000000000JH","billno":"264X201609140029","billtype":"2647","creator":"1001A5100000000000JK","defitem1":"保存","defitem10":"1002Z0100000000001K1","defitem11":"费用管理","defitem17":"yer","defitem2":"审批通过","deptid":"1001A5100000000000G3","dirty":"false","djdl":"bx","djzt":"1","dr":"0","pKFieldName":"pk_yerbill","payflag":"1","payflagname":"未支付","pk_group":"0001A510000000000D5V","pk_org":"0001A510000000002U0V","pk_yerbill":"0001A5100000000149GH","primaryKey":"0001A5100000000149GH","shrq":"2016-09-14","status":"0","tableName":"yer_yerexpbill","total":"9.00","tradeTypeName":"还款单","tradetype":"2647"},{"approver":"1001A5100000000000JW","approverName":"T2","approvestatus":"1","billdate":"2016-09-14","billid":"0001A5100000000149CG","billmaker":"1001A5100000000000JH","billno":"263X2016091400000069","billtype":"2631","creator":"1001A5100000000000JK","defitem1":"保存","defitem10":"1002Z0100000000001K1","defitem11":"费用管理","defitem17":"yer","defitem2":"审批通过","deptid":"1001A5100000000000G3","dirty":"false","djdl":"jk","djzt":"1","dr":"0","pKFieldName":"pk_yerbill","payflag":"1","payflagname":"未支付","pk_group":"0001A510000000000D5V","pk_org":"0001A510000000002U0V","pk_yerbill":"0001A5100000000149CG","primaryKey":"0001A5100000000149CG","shrq":"2016-09-14","status":"0","tableName":"yer_yerexpbill","total":"9.30","tradeTypeName":"差旅费借款单","tradetype":"2631"},{"approver":"1001A5100000000000JW","approverName":"T2","approvestatus":"1","billdate":"2016-09-14","billid":"0001A5100000000149BD","billmaker":"1001A5100000000000JH","billno":"263X2016091400000067","billtype":"2631","creator":"1001A5100000000000JK","defitem1":"保存","defitem10":"1002Z0100000000001K1","defitem11":"费用管理","defitem17":"yer","defitem2":"审批通过","deptid":"1001A5100000000000G3","dirty":"false","djdl":"jk","djzt":"1","dr":"0","pKFieldName":"pk_yerbill","payflag":"1","payflagname":"未支付","pk_group":"0001A510000000000D5V","pk_org":"0001A510000000002U0V","pk_yerbill":"0001A5100000000149BD","primaryKey":"0001A5100000000149BD","shrq":"2016-09-14","status":"0","tableName":"yer_yerexpbill","total":"9.29","tradeTypeName":"差旅费借款单","tradetype":"2631"},{"approvestatus":"-1","billdate":"2016-09-14","billid":"0001A5100000000149L9","billmaker":"1001A5100000000000JH","billno":"263X2016091400000074","billtype":"263X-Cxx-TYJKD","creator":"1001A5100000000000JK","defitem1":"保存","defitem10":"1002Z0100000000001K1","defitem11":"费用管理","defitem17":"yer","defitem2":"自由","deptid":"1001A5100000000000G3","dirty":"false","djdl":"jk","djzt":"1","dr":"0","pKFieldName":"pk_yerbill","payflag":"1","payflagname":"未支付","pk_group":"0001A510000000000D5V","pk_org":"0001A510000000002U0V","pk_yerbill":"0001A5100000000149L9","primaryKey":"0001A5100000000149L9","shrq":"","status":"0","tableName":"yer_yerexpbill","total":"9.57","tradeTypeName":"通用借款单","tradetype":"263X-Cxx-TYJKD"},{"approvestatus":"-1","billdate":"2016-09-14","billid":"0001A5100000000149F0","billmaker":"1001A5100000000000JH","billno":"263X2016091400000072","billtype":"2631","creator":"1001A5100000000000JK","defitem1":"保存","defitem10":"1002Z0100000000001K1","defitem11":"费用管理","defitem17":"yer","defitem2":"自由","deptid":"1001A5100000000000G3","dirty":"false","djdl":"jk","djzt":"1","dr":"0","pKFieldName":"pk_yerbill","payflag":"1","payflagname":"未支付","pk_group":"0001A510000000000D5V","pk_org":"0001A510000000002U0V","pk_yerbill":"0001A5100000000149F0","primaryKey":"0001A5100000000149F0","shrq":"","status":"0","tableName":"yer_yerexpbill","total":"9.31","tradeTypeName":"差旅费借款单","tradetype":"2631"},{"approvestatus":"-1","billdate":"2016-09-14","billid":"0001A5100000000149C8","billmaker":"1001A5100000000000JH","billno":"263X2016091400000068","billtype":"2631","creator":"1001A5100000000000JK","defitem1":"保存","defitem10":"1002Z0100000000001K1","defitem11":"费用管理","defitem17":"yer","defitem2":"自由","deptid":"1001A5100000000000G3","dirty":"false","djdl":"jk","djzt":"1","dr":"0","pKFieldName":"pk_yerbill","payflag":"1","payflagname":"未支付","pk_group":"0001A510000000000D5V","pk_org":"0001A510000000002U0V","pk_yerbill":"0001A5100000000149C8","primaryKey":"0001A5100000000149C8","shrq":"","status":"0","tableName":"yer_yerexpbill","total":"9.29","tradeTypeName":"差旅费借款单","tradetype":"2631"},{"approver":"1001A5100000000000JW","approverName":"T2","approvestatus":"1","billdate":"2016-09-13","billid":"0001A5100000000113PR","billmaker":"1001A5100000000000JH","billno":"263X2016091300000053","billtype":"2631","creator":"1001A5100000000000JK","defitem1":"审批","defitem10":"1002Z0100000000001K1","defitem11":"费用管理","defitem17":"yer","defitem2":"审批通过","deptid":"1001A5100000000000G3","dirty":"false","djdl":"jk","djzt":"2","dr":"0","pKFieldName":"pk_yerbill","payflag":"1","payflagname":"未支付","pk_group":"0001A510000000000D5V","pk_org":"0001A510000000002U0V","pk_yerbill":"0001A5100000000113PR","primaryKey":"0001A5100000000113PR","shrq":"2016-09-13","status":"0","tableName":"yer_yerexpbill","total":"100.00","tradeTypeName":"差旅费借款单","tradetype":"2631"},{"approver":"1001A5100000000000JW","approverName":"T2","approvestatus":"1","billdate":"2016-09-13","billid":"0001A51000000000YAUU","billmaker":"1001A5100000000000JH","billno":"263X2016091300000050","billtype":"2631","creator":"1001A5100000000000JK","defitem1":"审批","defitem10":"1002Z0100000000001K1","defitem11":"费用管理","defitem17":"yer","defitem2":"审批通过","deptid":"1001A5100000000000G3","dirty":"false","djdl":"jk","djzt":"2","dr":"0","pKFieldName":"pk_yerbill","payflag":"1","payflagname":"未支付","pk_group":"0001A510000000000D5V","pk_org":"0001A510000000002U0V","pk_yerbill":"0001A51000000000YAUU","primaryKey":"0001A51000000000YAUU","shrq":"2016-09-13","status":"0","tableName":"yer_yerexpbill","total":"5.00","tradeTypeName":"差旅费借款单","tradetype":"2631"},{"approver":"1001A5100000000000JW","approverName":"T2","approvestatus":"1","billdate":"2016-09-13","billid":"0001A51000000000YAOM","billmaker":"1001A5100000000000JH","billno":"263X2016091300000048","billtype":"2631","creator":"1001A5100000000000JK","defitem1":"审批","defitem10":"1002Z0100000000001K1","defitem11":"费用管理","defitem17":"yer","defitem2":"审批通过","deptid":"1001A5100000000000G3","dirty":"false","djdl":"jk","djzt":"2","dr":"0","pKFieldName":"pk_yerbill","payflag":"1","payflagname":"未支付","pk_group":"0001A510000000000D5V","pk_org":"0001A510000000002U0V","pk_yerbill":"0001A51000000000YAOM","primaryKey":"0001A51000000000YAOM","shrq":"2016-09-13","status":"0","tableName":"yer_yerexpbill","total":"5.00","tradeTypeName":"差旅费借款单","tradetype":"2631"},{"approver":"1001A5100000000000JW","approverName":"T2","approvestatus":"1","billdate":"2016-09-13","billid":"0001A51000000000YANU","billmaker":"1001A5100000000000JH","billno":"263X2016091300000047","billtype":"2631","creator":"1001A5100000000000JK","defitem1":"审批","defitem10":"1002Z0100000000001K1","defitem11":"费用管理","defitem17":"yer","defitem2":"审批通过","deptid":"1001A5100000000000G3","dirty":"false","djdl":"jk","djzt":"2","dr":"0","pKFieldName":"pk_yerbill","payflag":"1","payflagname":"未支付","pk_group":"0001A510000000000D5V","pk_org":"0001A510000000002U0V","pk_yerbill":"0001A51000000000YANU","primaryKey":"0001A51000000000YANU","shrq":"2016-09-13","status":"0","tableName":"yer_yerexpbill","total":"5.00","tradeTypeName":"差旅费借款单","tradetype":"2631"},{"approver":"1001A5100000000000JW","approverName":"T2","approvestatus":"1","billdate":"2016-09-13","billid":"0001A51000000000XQJZ","billmaker":"1001A5100000000000JH","billno":"263X2016091300000039","billtype":"2631","creator":"1001A5100000000000JK","defitem1":"审批","defitem10":"1002Z0100000000001K1","defitem11":"费用管理","defitem17":"yer","defitem2":"审批通过","deptid":"1001A5100000000000G3","dirty":"false","djdl":"jk","djzt":"2","dr":"0","pKFieldName":"pk_yerbill","payflag":"1","payflagname":"未支付","pk_group":"0001A510000000000D5V","pk_org":"0001A510000000002U0V","pk_yerbill":"0001A51000000000XQJZ","primaryKey":"0001A51000000000XQJZ","shrq":"2016-09-13","status":"0","tableName":"yer_yerexpbill","total":"9.17","tradeTypeName":"差旅费借款单","tradetype":"2631"},{"approver":"1001A5100000000000JW","approverName":"T2","approvestatus":"1","billdate":"2016-09-13","billid":"0001A51000000000YATZ","billmaker":"1001A5100000000000JH","billno":"263X2016091300000049","billtype":"2631","creator":"1001A5100000000000JK","defitem1":"审批","defitem10":"1002Z0100000000001K1","defitem11":"费用管理","defitem17":"yer","defitem2":"审批通过","deptid":"1001A5100000000000G3","dirty":"false","djdl":"jk","djzt":"2","dr":"0","pKFieldName":"pk_yerbill","payflag":"1","payflagname":"未支付","pk_group":"0001A510000000000D5V","pk_org":"0001A510000000002U0V","pk_yerbill":"0001A51000000000YATZ","primaryKey":"0001A51000000000YATZ","shrq":"2016-09-13","status":"0","tableName":"yer_yerexpbill","total":"5.00","tradeTypeName":"差旅费借款单","tradetype":"2631"},{"approver":"1001A5100000000000JW","approverName":"T2","approvestatus":"1","billdate":"2016-09-13","billid":"1001A510000000000TGL","billmaker":"1001A5100000000000JK","billno":"D12016091300000121","billtype":"D1","creator":"1001A5100000000000JK","defitem1":"保存","defitem10":"1002Z0100000000001K1","defitem17":"arap","defitem2":"审批通过","deptid":"D1","dirty":"false","djdl":"F1","djzt":"-1","dr":"0","pKFieldName":"pk_yerbill","payflag":"-100","payflagname":"","pk_group":"0001A510000000000D5V","pk_org":"0001A510000000002U0V","pk_tradetypeid":"D1","pk_yerbill":"1001A510000000000TGL","primaryKey":"1001A510000000000TGL","shrq":"2016-09-13","status":"0","tableName":"yer_yerexpbill","total":"19.15","tradeTypeName":"应付单","tradetype":"D1"},{"approver":"1001A5100000000000JW","approverName":"T2","approvestatus":"1","billdate":"2016-09-13","billid":"1001A510000000000TGF","billmaker":"1001A5100000000000JK","billno":"D02016091300000030","billtype":"D0","creator":"1001A5100000000000JK","defitem1":"保存","defitem10":"1002Z0100000000001K1","defitem17":"arap","defitem2":"审批通过","deptid":"D0","dirty":"false","djdl":"F0","djzt":"-1","dr":"0","pKFieldName":"pk_yerbill","payflag":"-100","payflagname":"","pk_group":"0001A510000000000D5V","pk_org":"0001A510000000002U0V","pk_tradetypeid":"D0","pk_yerbill":"1001A510000000000TGF","primaryKey":"1001A510000000000TGF","shrq":"2016-09-13","status":"0","tableName":"yer_yerexpbill","total":"19.14","tradeTypeName":"应收单","tradetype":"D0"},{"approver":"1001A5100000000000JW","approverName":"T2","approvestatus":"1","billdate":"2016-09-13","billid":"1001A510000000000TIY","billmaker":"1001A5100000000000JK","billno":"D22016091300000023","billtype":"D2","creator":"1001A5100000000000JK","defitem1":"保存","defitem10":"1002Z0100000000001K1","defitem17":"arap","defitem2":"审批通过","deptid":"D2","dirty":"false","djdl":"F2","djzt":"-1","dr":"0","pKFieldName":"pk_yerbill","payflag":"1","payflagname":"未支付","pk_group":"0001A510000000000D5V","pk_org":"0001A510000000002U0V","pk_tradetypeid":"D2","pk_yerbill":"1001A510000000000TIY","primaryKey":"1001A510000000000TIY","shrq":"2016-09-13","status":"0","tableName":"yer_yerexpbill","total":"19.21","tradeTypeName":"收款单","tradetype":"D2"},{"approver":"1001A5100000000000JW","approverName":"T2","approvestatus":"1","billdate":"2016-09-13","billid":"1001A510000000000TJ6","billmaker":"1001A5100000000000JK","billno":"D32016091300000038","billtype":"D3","creator":"1001A5100000000000JK","defitem1":"保存","defitem10":"1002Z0100000000001K1","defitem17":"arap","defitem2":"审批通过","deptid":"D3","dirty":"false","djdl":"F3","djzt":"-1","dr":"0","pKFieldName":"pk_yerbill","payflag":"1","payflagname":"未支付","pk_group":"0001A510000000000D5V","pk_org":"0001A510000000002U0V","pk_tradetypeid":"D3","pk_yerbill":"1001A510000000000TJ6","primaryKey":"1001A510000000000TJ6","shrq":"2016-09-13","status":"0","tableName":"yer_yerexpbill","total":"19.22","tradeTypeName":"付款单","tradetype":"D3"}],"success":true,"total":"25"}';
			if($_GET['callback']){
				$callback = $_GET['callback'];
				echo $callback.'('.$data.')';
			}else{
				echo $data;
			}
			exit();
		}

	}
